<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Demo KMZ (GPMB) + vệ tinh + tìm kiếm</title>

  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
  <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.css"/>
  <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.Default.css"/>
  <link rel="stylesheet" href="https://unpkg.com/nouislider@15.7.1/dist/nouislider.min.css"/>

  <link rel="stylesheet" href="./style.css" />
</head>
<body>
  <div class="topbar">
    <div class="brand">MAPDEMO</div>

    <div class="pillbar">
      <button class="pill active" data-tab="khuvuc">Khu vực</button>
      <button class="pill" data-tab="doituong">Đối tượng</button>
      <button class="pill" data-tab="gocranh">Đo nhanh</button>
      <button class="pill" data-tab="tothua">Tờ thửa</button>
    </div>

    <div class="right">
      <button id="btnTogglePanel" class="iconbtn" title="Bộ lọc">⚙️</button>
    </div>
  </div>

  <div id="map"></div>

  <aside id="panel" class="panel">
    <div class="panel-header">
      <div>
        <div class="panel-title">KMZ lên Web Map (Leaflet)</div>
        <div class="panel-sub">Mặc định vệ tinh + chữ; có lớp GPMB (từ KMZ) + tìm kiếm</div>
      </div>
      <button id="btnClosePanel" class="iconbtn" title="Đóng">✖</button>
    </div>

    <div class="section">
      <div class="section-title">Nền bản đồ</div>
      <label class="row"><input type="radio" name="basemap" id="rbSat" checked /> <span>Vệ tinh + chữ</span></label>
      <label class="row"><input type="radio" name="basemap" id="rbOSM" /> <span>OSM</span></label>
    </div>

    <div class="section">
      <div class="section-title">Lớp dữ liệu</div>
      <label class="row"><input type="checkbox" id="chkGPMB" checked /> <span>GPMB (KMZ → GeoJSON mẫu)</span></label>
      <label class="row"><input type="checkbox" id="chkParcels" /> <span>Thửa demo</span></label>
      <label class="row"><input type="checkbox" id="chkPlanning" /> <span>Quy hoạch demo</span></label>
      <label class="row"><input type="checkbox" id="chkRoute" /> <span>Trục tuyến demo</span></label>
      <label class="row"><input type="checkbox" id="chkListings" /> <span>Tin rao demo</span></label>
      <div class="note" id="gpmbStats">Đang tải lớp GPMB...</div>
    </div>

    <div class="section">
      <div class="section-title">Tìm kiếm đối tượng (GPMB)</div>
      <div class="row">
        <input id="inpObj" placeholder="Nhập tên/mã (trùng thì zoom cái đầu)" />
        <button id="btnObjFind" class="pill">Tìm</button>
      </div>
      <div class="hint">Gợi ý: copy đúng “name” trong popup để tìm nhanh.</div>
    </div>

    <div class="section">
      <div class="section-title">Tìm tờ/thửa (demo)</div>
      <div class="row">
        <input id="inpTo" placeholder="Số tờ" />
        <input id="inpThua" placeholder="Số thửa" />
        <button id="btnFind" class="pill">Tìm</button>
      </div>
      <div class="hint">Demo: thử tờ 12/13/21 và thửa 100–111.</div>
    </div>

    <div class="section">
      <div class="section-title">Lọc giá/diện tích (demo tin rao)</div>
      <div class="note">Bật “Tin rao demo” để dùng slider.</div>
      <div id="priceSlider"></div>
      <div class="hint"><span id="priceMin"></span> → <span id="priceMax"></span></div>
      <div id="areaSlider" style="margin-top:10px;"></div>
      <div class="hint"><span id="areaMin"></span> → <span id="areaMax"></span></div>
    </div>

    <div class="section">
      <div class="section-title">Đo nhanh (2 điểm)</div>
      <div class="note">Bấm 2 điểm bất kỳ để đo khoảng cách. Bấm tiếp để đo cặp mới.</div>
    </div>
  </aside>

  <div id="toast" class="toast" hidden></div>

  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script src="https://unpkg.com/leaflet.markercluster@1.5.3/dist/leaflet.markercluster.js"></script>
  <script src="https://unpkg.com/nouislider@15.7.1/dist/nouislider.min.js"></script>

  <script src="./app.js"></script>
</body>
</html>
